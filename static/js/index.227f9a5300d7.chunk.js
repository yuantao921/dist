import{j as r,o as b,a9 as x,b9 as v,r as f,aG as w,n as s,ar as l,av as d,ai as c,bf as _,ce as N}from"./vendor.83d59a4358fc.chunk.js";import{M as y,t as C,v as D,m as I,b as G}from"./index.8aebe18ecbfa.js";import{D as O}from"./DataGrid.43a54455eaf3.chunk.js";import{O as a}from"./order.269a0794995b.chunk.js";const L=({children:e,className:o})=>r(y,{className:o,content:!1,children:e}),P=()=>{const{t:e}=b(),{data:o,isLoading:u}=C(void 0,{pollingInterval:1e3*60}),[p,{isLoading:g}]=D(),{enqueueSnackbar:i}=x(),[m,h]=v.useState(10),S=f.useMemo(()=>[{field:"trade_no",headerName:e("order.list.table.trade_no",{context:"header"}).toString(),description:e("order.list.table.trade_no",{context:"description"}).toString(),width:240,type:"string",renderCell:t=>r(w,{component:s,to:`/order/${t.value}`,underline:"none",children:t.value}),sortComparator:(t,n)=>parseInt(t)-parseInt(n)},{field:"plan.name",headerName:e("order.list.table.plan_name",{context:"header"}).toString(),description:e("order.list.table.plan_name",{context:"description"}).toString(),width:180,type:"string",valueGetter:t=>t.row.plan.name},{field:"total_amount",headerName:e("order.list.table.total_amount",{context:"header"}).toString(),description:e("order.list.table.total_amount",{context:"description"}).toString(),width:180,type:"number",valueGetter:t=>t.row.total_amount/100,valueFormatter:t=>`${t.value.toFixed(2)} CNY`},{field:"period",sortable:!1,headerName:e("order.list.table.period",{context:"header"}).toString(),description:e("order.list.table.period",{context:"description"}).toString(),width:120,type:"string",valueFormatter:t=>e("order.list.table.period-value",{context:t.value}).toString()},{field:"status",headerName:e("order.list.table.status",{context:"header"}).toString(),description:e("order.list.table.status",{context:"description"}).toString(),width:120,type:"string",sortable:!1,valueFormatter:t=>{switch(t.value){case a.PENDING:return e("order.list.table.status-value",{context:"pending"}).toString();case a.PAID:return e("order.list.table.status-value",{context:"paid"}).toString();case a.CANCELLED:return e("order.list.table.status-value",{context:"cancelled"}).toString();case a.FINISHED:return e("order.list.table.status-value",{context:"finished"}).toString();default:return t.value}}},{field:"created_at",headerName:e("order.list.table.created_at",{context:"header"}).toString(),description:e("order.list.table.created_at",{context:"description"}).toString(),width:180,type:"dateTime",valueGetter:t=>l.unix(t.row.created_at).toDate(),valueFormatter:t=>l(t.value).format("YYYY-MM-DD HH:mm:ss")},{field:"actions",headerName:e("order.list.table.action",{context:"header"}).toString(),width:120,sortable:!1,type:"actions",getActions:t=>[r(d,{title:e("order.list.table.action-view",{context:"tooltip"}).toString(),children:r(c,{size:"small",component:s,to:`/order/${t.row.trade_no}`,children:r(_,{})})},t.id),...t.row.status===a.PENDING?[r(d,{title:e("order.list.table.action-cancel",{context:"tooltip"}).toString(),children:r(c,{size:"small",onClick:()=>{p(t.row.trade_no).unwrap().then(()=>{i(e("notice::order-cancel",{context:"success"}).toString(),{variant:"success"})}).catch(n=>{console.error("error cancelling order",n),i(e("notice::order-cancel",{context:"fail"}).toString(),{variant:"error"})})},disabled:g,children:r(N,{})})},t.id)]:[]]}],[o,e]);return r(O,{columns:S,rows:o!=null?o:[],loading:u,getRowId:t=>t.trade_no,rowsPerPageOptions:[5,10,25,50],pageSize:m,onPageSizeChange:t=>h(t)})},E=I()(e=>({root:{flexGrow:1,height:"100%",display:"flex",flexDirection:"column"}})),k=()=>{const{classes:e}=E();return r(L,{className:e.root,children:r(P,{})})},Y=()=>(G("order-list"),r(k,{}));export{Y as default};
